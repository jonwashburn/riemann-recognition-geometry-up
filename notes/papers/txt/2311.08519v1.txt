3
2
0
2

v
o
N
4
1

]
T
N
.
h
t
a
m

[

1
v
9
1
5
8
0
.
1
1
3
2
:
v
i
X
r
a

A probabilistic interpretation of Weil’s explicit
sums and arithmetic spectral measures.

´Angel Alfredo Mor´an Ledezma

November 16, 2023

Abstract

In this paper we study the connections of three paradigms in num-
ber theory: the adelic formulation of the Riemann zeta function, the
Weil explicit formula and the concepts of the so called probabilistic
number theory initiated by Harald Bohr. We give a diﬀerent reformu-
lation, rooted in the adelic framework, of the theory of distribution
values of the Riemann zeta function. By introducing the Bohr com-
pactiﬁcation of the real numbers as a natural probability space for
this theory, we show that the Weil explicit sum can be expressed in
terms of covariances and expected values attached to random vari-
ables deﬁned on this space. Moreover, we express the explicit formula
as a limit of spectral integrals attached to operators deﬁned on the
Hilbert space of square-integrable functions on the Bohr compactiﬁ-
cation. This gives a probabilistic and a geometrical interpretation of
the Weil explicit formula.

1

Introduction.

Many diﬀerent realms of mathematics are involved in the description of the
behavior of the Riemann zeta function. One of them is probability theory.
This branch of mathematics, the so called probabilistic number theory has
diﬀerent deﬁnitions for diﬀerent authors, here we will understand it as the
study of the distribution values of arithmetic objects such as Dirichlet series.
This theory has been employed successfully to study the analytic properties
of a large class of L-functions, for example, the so called universality property

1

 
 
 
 
 
 
of zeta functions. In particular the following problem is usually investigated:
given some set, how often do values of an arithmetic object get into this
set? This frequency follow strict mathematical laws, and as stated by L.
Laurinˇcikas in [15], this give an analogy with quantum mechanics where it
is impossible to describe the chaotic behavior of one particle (in this case
concrete values of the zeta function), but a large number of particles obey
statistical laws. H. Bohr devoted his scientiﬁc carrier in the study of such
distributions. Together with his student B. Jessen were able to describe in
probabilistic terms the complicated behavior of the function t ÞÑ log ζpσ ` itq
for t P R and and σ ą 1
2, where σ ` it lies in the zero-free region of ζ in the
strip 1
2 ă σ ď 1 (see Theorem 1 and Theorem 2), this result is usually called
the Bohr-Jessen limit theorem and describes the limit behavior as T Ñ 8,
of the probability measures given by 1
2T µ0ptt P r´T, T s : ζpσ ` itq P Aq,
where A Ă C is open and µ0 denotes the usual Lebesgue measure on the
real numbers. In other words, one is interested in the asymptotic behavior
of the complex random variable t ÞÑ ζpσ ` itq, deﬁned on the probability
space pr´T, T s, µ0{2T q [3].
In this work we investigate how this theory is
connected with other two paradigms in number theory: the Iwasawa-Tate
theory, which allow us to represent the zeta function as an adelic integral
over certain idele group, and the well know Weil explicit sums, which en-
capsulate the relationship between the distribution of the prime numbers on
the real line and the zeroes of the zeta function. This last two subjects are
already connected. Works that shows this connection include the results of
S. Haran, for example in [9] and by the well known results of A. Connes
[6]. Both of them achieve to obtain diﬀerent geometric expressions for the
Weil explicit sums as an additive convolution with the so called Riesz po-
tential and as Trace formula, respectively. This results can be considered as
part of the framework of the Polya-Hilbert project on the study of the Rie-
mann Hypothesis. This work aims to contribute in two diﬀerent ways: one
is exhibit explicitly the connections with the Bohr-Jessen probability theory
and the adelic theory of the Riemann zeta function by presenting a new ap-
proach of the formulation of how we can understand the limit distribution
generated by the random variable t ÞÑ ζpσ ` itq in both context (adelic and
probabilistic), this is explained in the ﬁrst chapter and is motivated by an
observation of S. Haran given in [10]. The second one is the interpretation of
the Weil explicit sums in this probabilistic framework. By using the concept
of ”oﬀ-diagonal” zeta function, we present the Bohr compactiﬁcation of the
reals, denoted by B (and isomorphic to the non-necesarilly continuous homo-

2

morphisms HomrR, S1s from the additive group of the real numbers to the
complex unit circle) as the natural framework to develop the known theory
of probabilistic number theory. Remember that for Repsq ą 1 the com-
plete Riemann zeta function can be understood as an adelic integral taking
values on C “ HomcontpA˚{Z˚
AQ˚, C˚q. This space is embedded diagonally
on HomcontpA˚{Z˚
A, C˚q. The ”oﬀ-diagonal” functions that appeared in this
work can be understood as extensions of ﬁnite-adelic integrals taking val-
ues on a compact subdomain of HomcontpA˚{Z˚
A, C˚q. It turns out that this
functions can be considered as random variables on the Bohr compactiﬁca-
tion of the reals, and as a ﬁrst result we show in Theorem 4 the connection
of the ”oﬀ-diagonal” Riemann zeta function and the Bohr-Jessen limit theo-
rem. Therefore we expect that this observation gives a natural reformulation
rooted on the Adelic framework of the works of Bohr, Jessen, Matsumoto,
Laurincickas, Takanobu and others (see for example [18, 15, 3, 1]). The sec-
ond part of this paper is devoted to the study of the Weil explicit sums. It
was shown by A. Weil [22] that the Riemann Hypothesis is equivalent to the
negativity of the right-hand side of the Weil explicit formula:

Mpf ˚ ¯f ˚qp0q`Mpf ˚ ¯f ˚qp1q ´

Mpf ˚ ¯f ˚qpsq

ζQpsq“0
ÿ

Mpf ˚ ¯f ˚qpsqd log

ζpp1 ´ sq
ζppsq

,

1{2`i8

“

1{2´i8

pď8 ż
ÿ

c pR˚

where ζppsq “ p1 ´ p´sq´1 for prime p ă 8, ζ8psq “ π´s{2Γp s
2q and ζQ is
the complete Riemann zeta function. Here, f P C 8
`q and Mpf qpsq “
8
0 f pxqxs dx
x is the Mellin transform of f . The right hand side, denoted by
W pf ˚ ¯f ˚q shows the relationship between the zeroes of the zeta function
ş
In order to study this objetct in the probability
and the prime numbers.
p-invariant functions of L2pQ˚
framework ﬁrst we show that the Z˚
pq form a
subspace of L2pBq where the p-adic Mellin transform gives the isometry.
Moreover, using the structure of C ˚-algebra of CpBq, the space of continuous
pqZ˚
functions on B, we show that L1pQ˚
p can be embedded in CpBq using the
Mellin transform preserving the compatibility of involutions of ˚´algebras.
This allow us to construct many diﬀerent random variables, in particular, for
`q its restriction to the lattice generated by tpk :
any function on f P C 8
pqZ˚
p is prime, k P Zu generate a well deﬁned function on L1pQ˚
p ,
for very prime p, and therefore a random variable in CpBq. With this we
are able to show that the local terms in the Weil explicit sum are in fact

p X L2pQ˚

c pR˚

pqZ˚

3

ζ restricted on the critical line Repsq “ 1

a covariance (also an expected value) of the random variable generated by
f and the random variable generated by Re d
ds log ζppsq, the real part of
the logarithmic derivative of the local factor of the Riemann zeta function
(Theorem 5 and Theorem 6). Moreover, since L2pBq provides a faithful
representation of the C ˚´algebra CpBq, this covariance (and therefore the
ﬁnite part of the Weil explicit sum, p ă 8) can be interpreted as an spectral
integral generated by the multiplication operator attached to the real part
of the ”oﬀ-diagonal” logarithmic derivative of the Riemann zeta function
Re ζ 1
2. With this we get two types
of descriptions, one of probabilistic nature and one of geometrical nature.
Chapter 4 is devoted to the extension of this results now considering also
the archimedean place. For this, inspired by the ideas of [10] and [7] we use
the q-discretization of the gamma function to give an approximation of the
complete Weil explicit sum. We show that the so called q-calculus appeared
naturally in the spaces L2pBq and CpBq. This allow us to achieve a full
description of the Weil explicit sum in terms of the probabilistic framework
of the probability space pB, dχq where dχ denotes the Haar measure of B,
therefore the Riemann hypothesis becomes equivalent to an upper bound to
certain covariance or the negativity of certain expected value (Corollary 1).
Moreover, we show that W pf ˚ ¯f ˚q can be understood as a limit of expected
values and as a limit of spectral integrals of operators deﬁned on L2pBq
(Theorem 8, Corollary 1, Theorem 9, Corollary 2). The analytical structure
of CpBq as a C ˚-algebra and its connection with almost periodic functions, is
already very well known by the physics community since this space appears
naturally in the description of the theory of Polymer Quantum Mechanics
(PQM) [20, 21, 8].
In chapter 5 we present some outlook regarding this
connection with PQM, and proposing this theory as a possible alternative
way to explore the ideas of the Polya-Hilbert project.

2 Preliminaries: The diagonal zeta function.

In this section we present one important observation given by S. Haran in
[10], which allow us to introduce the main idea behind the results of this
work. The goal is to understand the relationships between three paradigms
in Number Theory, namely, the ideas of Tate-Iwasawa Theory, The Weil ex-
plicit sums and the Bohr-Jessen probability theory of the zeta function.

4

p´invariant theory (locally), where Z˚

We are interested in the unramieﬁed part of Tate-Iwasawa theory, that is
p denotes the multiplica-
p the multiplicative group of Qp
p “ tx P Zp : |x|p “ 1u,

on the on the Z˚
tive group of the p-adic integers. Denote by Q˚
with the attached Haar measure d˚µp , also we have Z˚
where | ¨ |p is the canonical absolute value on Qp. We have that

Q˚

p{Z˚

p “ pZ,

By taking the corresponding Pontryagin dual we obtain

Q˚

p{Z˚

p “ iR{

2πi
log p

Z,

That is, any element of HomcontpQ˚
correspond to the unramiﬁed characters on Q˚
quasi-characters

p{Z˚

{

p, S1q is of the form | ¨ |it

p . These
p. More generally for unramiﬁed

HomcontpQ˚

p{Z˚

p, C˚q “ C{

2πi
log p

Z,

that is, an element χ in this space is of the form χ “ | ¨ |σ`it

.

p

For f pxq “ f p|x|pq P CcpQ˚

p , we deﬁne its local Mellin transform at
χ “ |¨|σ`it or equivalently at s “ σ`it as the multiplicative Fourier transform
of f | ¨ |σ

p , i.e.,

pqZ˚

Mppf qpsq :“

żQ˚

p

f p|x|pq|x|s

pd˚µppxq “

f pp´kqp´ks.

kPZ
ÿ

The local factor of the zeta function is then ζppsq “ Mppφpqpsq “ p1 ´ p´sq´1,
where φppxq “ 1Zppxq, the indicator function of Zp . In his Thesis [19], John
Tate makes the following observation,

”We can do nothing really signiﬁcant with the idele group until we
imbed the multiplicative group K ˚ of K in it ”.

— John Tate

As stated by J. Tate, in the Global Theory, we are not interested in all the
characters of the Id`ele group A˚. This is resumed in the following description
of the quasi-characters of the Id`ele class group A˚{Q˚:

HomcontpA˚{Q˚, C˚q Q χ “ ηp¨q| ¨ |σ`it

A

,

5

where η is the ramiﬁed part of the character χ, or in the unramiﬁed case:

C “ HomcontpA˚{Z˚

AQ˚, C˚q Q χ “ | ¨ |σ`it

A

,

where Z˚
Adenotes the group of units in the ring of Adele integers. Therefore,
for a suﬃciently nice function f , its Global Mellin transform is deﬁned at the
quasi-character χ “ | ¨ |s

A, or equivalently at s “ σ ` it by the integral

Mpf qpχq :“

f pxqχpxqd˚µApxq,

żA˚

In particular for the function φ “ bpď8φp, where φ8 “ e´πx2, and for ﬁxed
Repsq “ σ ą 1, its global Mellin transform gives the complete Riemann zeta
function

ζQpsq “ Mpφqpsq “

With the convergent Euler product

φpxq|x|s

Ad˚µA˚pxq,

żA˚

ζQpsq “

ζppsq.

pď8
ź
This leads us to understand the function χ ÞÑ ζQpχq as a restriction on the
diagonal generated by the following embedding:

C “ HomcontpA˚{Z˚

AQ˚, C˚q ãÑ HomcontpA˚{Z˚

A, C˚q

where

HomcontpA˚{Z˚

A, C˚q “ C ˆ

Therefore we can rewrite the Euler product as:

pă8
ź

C{

2πi
log p

Z,

ζQpsq “

ζppspq|sp“s.

pď8
ź

2.1 The oﬀ-diagonal zeta function as a random vari-

able.

We now extend the above observation given by S. Haran, we present a way
to understand the oﬀ diagonal zeta function. The Riemann zeta function is
deﬁned by the contribution of the ﬁnite primes:

s ÞÑ ζpsq :“

ζppsq,

pă8
ź

6

for Repsq ą 1. As the case above, this can be seen as the restriction (of a more
general function) to the diagonal C. In order to give a formal description of
this, consider the space

HomcontpA˚

f {ˆZ˚, C˚q “

C{

2πi
log p

Z

pă8
ź

f denotes the multiplicative ring of ﬁnite Ad`eles and ˆZ the ring of
where A˚
proﬁnite integers. For our analysis, we are interested in the behavior of the
Riemann zeta function in the region Repsq “ σ , hence we ﬁx a real part
σ ą 0 and consider the Pontryiagin dual instead:

Ω :“ HomcontpA˚

f {ˆZ˚, S1q “

iR{

2πi
log p

Z.

pă8
ź

By Tychonoﬀ’s Theorem, Ω is a compact abelian group equipped with coor-
dinatewise multiplication. Then we can take the oﬀ-diagonal zeta function
deﬁned by (formally)

Ω Q χ ÞÑ

ζppσ, χq “: ζpσ, χq,

(1)

pă8
ź

|x|σ

where the expression, ζppσ, χq “

p χpxqdx denotes the local zeta func-
tion taking values on
p, that is, quasi characters with ﬁxed real part
Repχq “ σ. Since there exists a probability measure on the space Ω, we can
ask about the behavior of p1q in probabilistic terms. We have the following
Lemma.

p{Z˚

{

Q˚

Zp

ş

Lemma 1. The product (1) converges almost surely. The assignation χ ÞÑ
ζpσ, χq is a well deﬁned complex-valued random variable on the space Ω.

Proof. The proof follows from the proof of Lemma 5.1.7. in [15]. The main
observation is to notice that the space Ω is isomorphic to the space Ω1 deﬁned
below.

In fact, product p1q was already considered by Bagchi and later by Lau-
rincickas and other authors in order to describe the property of universality
of the Riemann zeta function in probabilistic terms. For more details, the

7

reader may consult for example [2, 15]. Nevertheless they presented this func-
tion in an equivalent way: let S1 be the complex unit circle, and consider the
copies indexed by the prime numbers tS1

p u. Let

1

Ω

:“

S1
p ,

p
ź

(2)

which, by Tychonoﬀ’s Theorem, is a compact Abelian group equipped with
coordinate-wise multiplication. Hence, there exists a unique probability mea-
sure on the σ-algebra of Borel sets. Deﬁne the assignment

ω ÞÑ ζpσ, ωq “

1 `

pă8 ˜
ź

ωppqk
pkσ

,

¸

8

k“1
ÿ

(3)

where ω ÞÑ ωppq is the canonical projection in the coordinate p. This is
an almost surely convergent product and a well-deﬁned C-valued random
element deﬁned on Ω1 (this is a slight variation of Lemma 5.1.7.
in [15]).
Moreover, the following holds:

8

ζpσ, ωq “

ωpkqk´σ,

(4)

p pαppq. As we will
where ωpkq its deﬁned by ωpkq :“
see, the ”oﬀ-diagonal zeta function” p1q will allow us to give a probability
interpretation of the Weil explicit formula which will introduced in the next
chapter.

ś

ś

k“1
ÿ
p ωppqαppq, and k “

2.2 Weil Explicit Formula

In [17], Riemann shows a fundamental result on how the prime numbers and
the zeros of the Riemann zeta function are related. An ”Explicit formula”
was introduced to study the prime numbers less than a given magnitude. This
formula was made rigorous and generalized by many authors, a particularly
formidable formula was rigorously proved by von Mangoldt:

Λpnq `

1
2

Λpxq “ x ´

xρ
ρ

´ logp2πq ´

1
2

logp1 ´ x2q,

(5)

1ănăx
ÿ

where x ą 1 (not necesarily an integer), and Λpyq “ logppq if y ą 1 is
a positive power of the prime number p, and 0 otherwise. The number

ρ
ÿ

8

ρ runs through the zeros of Riemann zeta function. Although Riemann
already knew the exact relation between the zeros of the zeta function and
the distribution of the primes, it was Weil who ”crystallized” this in his
explicit sums (formula) [22]. Given f : R` Ñ R smooth and compactly
0 f pxqxs dx
supported, we associate with f its Mellin transform Mpf qpsq “
x .
We have by the functional equation ζQpsq “ ζQp1 ´ sq:

8

ş

Mpf qp0q`Mpf qp1q ´

Mpf qpsq “ ´

Mpf qpsqd log ζQpsq

ζQpsq“0
ÿ

1{2`i8

“

Mpf qpsqd log

1{2´i8

pď8 ż
ÿ

1
2πi

¿
ζpp1 ´ sq
ζppsq

,

(6)

where ζppsq “ p1 ´ p´sq´1 for prime p ă 8, and ζ8psq “ π´s{2Γp s
by

2q. Denote

1{2`i8

Wppf q :“

Mpf qpsqd log

1{2´i8

ż

ζpp1 ´ sq
ζppsq

1{2`i8

W8pf q :“

Mpf qpsqd log

and the ﬁnite Weil sum,

1{2´i8

ż

k‰0
ÿ
ζ8p1 ´ sq
ζ8psq

,

“ log p

f ppkq minppk, 1q,

Wf inpf q :“

Wppf q.

pă8
ÿ

The Riemann Hypothesis is equivalent to the Weil Negativity Criterion of
the Weil sum:

W pf q :“

Wppf q ď 0,

for complex-valued test functions of the positive half-line of the form

pď8
ÿ

8

f pxq “

gpxyqgpyqdy, Mpgqp1q “ 0, Mpgqp0q “ 0.

0

ż

In fact, it is enough to prove the negativity of W for functions g with compact
support in the (locally compact) multiplicative group R˚
` “ p0, 8q. Further-
more, given any set of complex numbers F Ą t0, 1u with F X ts : ξpsq “ 0u “
H, we have that the Riemann hypothesis is equivalent to

W pg ˚ g˚q ď 0,

9

x gp 1

c pR˚

`q, such that Mpgqpsq “ 0 for all s P F and g˚pxq “ 1

for all g P C 8
xq,
see [23, 7]. Following [7], it is worth to notice that W pf q only involves a ﬁnite
set of primes when evaluated on a test function with compact support. That
is, even though the Riemann Hypothesis is about the asymptotic distribution
of the primes, this equivalent formulation involves ﬁnitely many primes at
a time. With this in mind, for functions with support contained in p1{2, 2q,
we have that W pf q “ W8pf q.
In this case, in [23] and [7] showed that
W8pf q ď 0 . In particular, in [7], Connes and Consani give operator theoretic
conceptual reasons for Weil’s criterion. Our approach is diﬀerent. One goal is
to show the natural link between the C ˚-algebra CpBq of continuous complex-
valued functions over B, the Bohr compactiﬁcation of R, the probabilistic
interpretation of almost periodic functions, and the Weil sum W pf q.

2.3 The Bohr Compactiﬁcation

Consider the real line R equipped with the additive commutative group struc-
ture. The Bohr compactiﬁcation B can be described as the set HomrR, S1s
of all, not necessarily continuous, group morphisms from the group R to the
multiplicative group S1. Equivalently we can describe B by the following

Deﬁnition 1. The spectrum of a unital Banach algebra A is the set of all
non-zero ˚-homomorphisims χ : A Ñ C; a ÞÑ χpaq, called the characters.

Deﬁnition 2.
2π{k by

1. For any k P R deﬁne the periodic functions of period

Tk : R Ñ C; x ÞÑ eikx,
The ˚-algebra C of almost periodic functions is the ﬁnite complex linear
span of the functions Tk, that is, functions of the form

f “

N
I“1 zITkI where N ă 8, kI P R, zI P C

ř

2. Let C be the closure of C with respect the sup-norm on R. This is
an abelian C ˚-algebra with respect to pointwise operations and complex
conjugation as involution. The spectrum of this algebra denoted by B
is called the Bohr compactiﬁcation of R.

For more details the reader may consult [11, 12, 20]. Let χ P B, that is,
an arbitrary homomorphism χ : C Ñ C without any continuity assumption.

10

Any such character is determined once we know its values Xpkq :“ χpTkq.
Since

XpkqXplq “ Xpk ` lq, Xpkq “ Xp´kq,

(7)

we have that X : R Ñ S1 is a group homomorphism which does not need to
be continuous, that is B “ HomrR, S1s as stated. The above compactiﬁcation
can be extended to any topological group, moreover it is worth noticing the
following. Let G “ R be the topological group of the real numbers with
addition and the euclidean topology. Consider the Pontryagin dual of G
equipped with the discrete topology denoted by ˆGd. Then the Pontryagin
dual of this group coincides with B. Hence, it is clear that for any self dual
group G, its Bohr compactiﬁcation is given by HomrG, S1s.

Remark 1. The space C is also known as the set of uniformly almost periodic
functions over R. In fact any such function can be seen as the restriction
f |R of f P CpBq, the space of continuous functions over B. Moreover, the
operator f ÞÑ f |R is an isometric ˚´isomorphisim of CpBq onto C.

Let f P C, then we will denote by ˆf : B Ñ C the associated lift func-
tion given by ˆf pχq “ χpf q for every χ P B.
In particular, the maps ˆTk
will represent the map χ ÞÑ χpTkq. For a set of functions A Ă C, we set
ˆA “ t ˆf : f P Au. The topology of B can be described in diﬀerent ways. For
our purposes we will use diﬀerent equivalent ways to describe said topology.
Since HomrR, S1s is a closed group of
k “ S1, and since
this product is compact by Tychonoﬀ’s Theorem, we have that the induced
topology on B makes this space a compact topological space. Moreover, B is a
compact Hausdorﬀ group, which implies the existence of a unique normalized
Haar measure denoted by dχ. The construction of this measure can be real-
ized using the Riesz Representation Theorem in the following way. For any
f P C and x P R we have the following map x ÞÑ χxp¨q where χxpf q “ f pxq.
This map embeds the group R densely into the group B. Moreover, since the
attached homomorphism X P HomrR, S1s is given by Xpkq “ χxpTkq “ eikx.
Therefore, by using (1), R is embedded into B as the set of smooth homo-
morphisms.

k, where S1

kPR S1

ś

Let S “ tTk : k P Ru be the total set generating C. Then, by the Stone-
S separates
S Ă CpBq ÞÑ R ,

Weierstrass Theorem, the algebra span
points and contains the constant functions. Let Λ : span

S is dense in CpBq, since

p

11

p

p

be the positive linear functional given by

Λp ˆTkq “ δk,0,

where δ denotes the Kronecker delta. By the Riesz-Markov representation
Theorem, there is a unique Radon measure (which can be easily proved to
be the Haar measure with the standard normalization), such that

ΛpF q “

F pχqdχ.

żB

S is an orthonormal basis of L2pB, dχq, and since
This implies that the set
the function 1 : B Ñ R, 1pχq “ 1 is given by 1 “ ˆT0, the measure of B is
1. Therefore, the space pB, B, dχq is a probability space, where B is the σ-
algebra of Borel sets of B. Henceforth we may refer to the probability space
pB, B, dχq as the Bohr space. The following lemma relates the Haar measure
of B and the usual Lebesgue measure of R. For the proof the reader may
consult [20, Equation 28.2.8].

p

Lemma 2. Let f P CpBq, then

f pχqdχ “ lim

T Ñ`8

żB
where dx is the Lebesgue measure of R.

1
2T

T

´T
ż

f |Rpxqdx,

In particular for any k-periodic continuous function f ptq, we have

ˆf pχqdχ “ lim
T Ñ`8

żB

1
2T

T

´T

ż

f pxqdx “

k
2π

2π{k

f ptqdt.

0

ż

3 An arithmetic random process and Weil

Explicit Sums.

p and L2pQ˚

pqZ˚
p “ L2pQ˚
p{Z˚

3.1 The L1pQ˚
pqZ˚
Let L2pQ˚
pq, which by the Plancherel Theorem is isomorphic
to L2piR{ 2πi
log p Zq, the later can be identiﬁed with the span of the functions
eikt log p, for k P Z. These functions can be identiﬁed with the functions

p embedding.

pqZ˚

12

ˆTlog pk P L2pBq. Therefore the space L2pQ˚
p is isomorphic with the span of
the functions of the form ˆTlog pk for k P Z, a subspace of L2pBq. Moreover,
the Mellin transform for real part σ “ 0 gives a linear isometry, that is, for
f P L2pQ˚

p

pqZ˚

pqZ˚

Mppf qpitq “

ÞÑ

żQ˚

p

kPZ
ÿ

f p|x|pq|x|it

p d˚µppxq “

f pp´kqp´ikt

f pp´kq ˆTlog p´k P L2pBq,

kPZ
ÿ

More generally, for σ ě 0,

χ ÞÑ Mppf qpσ, χq “

f pp´kqp´σkχpTlogp´kq P L2pBq,

8

k“´8
ÿ

if and only if

8

k“´8
ÿ

|f pp´kq|2p´2σk “

żQ˚

p

in such case we have

|f p|x|pq|2|x|2σ

p dµ˚

ppxq ă `8,

||Mppf qpσ, ¨q||B “ ||f p¨q| ¨ |σ

p .
p ||Q˚

(8)

Note that this gives us a family of square-integrable complex random vari-
ables Mppf qpσ, χq indexed by f P L2pQ˚

p, |x|2σ

p d˚µpq, that is
p, |x|σ

p d˚µpq is linearly iso-

Lemma 3. For every 0 ď σ ă 1 the space L2pQ˚
metric to a subspace of L2pBq.

Now, let M, N P L2pBq two random variables. Then the following holds

1. ErMs “ xM, ˆT0yB

2. V arrMs “ ||M||2

L2pBq ´ |ΛpMq|2

3. The covariance of M and N satisﬁes, CovrM, Ns “ xM, NyL2pBq ´

ΛpMqΛpNq.

In particular, for a random variable of the form Mppf qpσ, ¨q we have

ErMppf qpσ, ¨qs “ xMppf qpσ, ¨q, ˆT0yL2pBq “ f p1q.

13

8

Remark 2. More generally we have the following random variables. Let
n“1 ane´λns be a Dirichlet series, convergent in the half-plane Repsq ą
Lpsq “
σ0, and denote by Lnpsq its partial sum. Let s “ σ ` it, where σ is ﬁxed and
such that t ÞÑ Lnpσ ` itq converges to t ÞÑ Lpσ ` itq with respect to || ¨ ||8 ,
then it is clear that

ř

8

L “

ane´λnσ ˆT´λn,

deﬁnes a continuous random variable on the Bohr space.

n“1
ÿ

Let f ˚pxq “ 1
|x|p

f p 1
|x|p

q for x ‰ 0. L1pQ˚

p, dµ˚

pqZ˚

tiplicative convolution and the involution given by f ÞÑ |x|pf
*-algebra. The Mellin transform satisﬁes

p equipped with the mul-
“: f #pxq is a

˚

˚

Mppf

qpσ, χq “ Mppf qp1 ´ σ, χq,

and for σ “ 1

2 we have

Mppf

˚

qp

1
2

, χq “ Mppf qp

1
2

, χq,

for Mppf qp 1
on CpBq.

2, ¨q continuous the map f ÞÑ f

˚

is compatible with the involution

Proposition 1. The space L1pQpqZ˚
involutions of *-algebras are compatible.

p

is embedded in CpBq, moreover the

Proof. Consider the map λ : L1pQ˚
λpgqpxq “ f pxq, where f pxq “ |x|´1{2
g ÞÑ g# to the involution f ÞÑ f
element of the algebra CpBq. Indeed, since

p, dµ˚

p Ñ L1pQ˚

p, |x|1{2
p , given by
gpxq, then this map take the involution
2, χq is an

p
˚
. Moreover, the function Mppf qp 1

p dµ˚

pqZ˚

pqZ˚

Mppf qp

1
2

8

` itq “

gpp´kqp´ikt,

k“´8
ÿ

by the Weierstrass M-test, the series converges uniformly, and can be ex-
tended to a continuous function on B.

Remark 3. Moreover, by equation p8q the map Mpp¨qp1{2, ¨q˝λ : L2pQ˚
L2pBq, is a linear isometry.

p, dµ˚

pqZ˚

p Ñ

14

The convolution and multiplication on CpBq are related by the well now

convolution theorem:
Proposition 2. Let f, g such that Mppf qpσ, ¨q and Mppgqpσ, ¨q exists. Then
it holds true that

Mppf ˚ gqpσ, ¨q “ Mppf qpσ, ¨qMppgqpσ, ¨q.

3.2

Interlude: The Bohr-Jessen limit theorem.

The value-distribution theory is the life-work of Harald Bohr. In the 1930’s,
let R Ă C be a
Bohr was able to prove the following fundamental result:
rectangle in the complex plane, whose edges are parallel to the coordinate
axes. Denote by µ0 the one-dimensional Lebesgue measure. From the half
plane σ ą 1
2, we remove all the points which have the same imaginary part
as, and smaller real part than, one of the possible zeros or the pole of ζ in this
region, and the remaining part we denote by G. Then the following holds,
Theorem 1. (Bohr-Jessen [3]) For any σ ą 1

2, the limit value

BpR, σ, ζq “ lim
T Ñ8

1
2T

exists.

µ0ptt P r´T, T s : σ ` it P G, log ζpσ ` itq P Ruq,

Bohr and Jessen themselves developed an advanced geometric theory of
sums of closed convex curves whose results are used in the proof of Theorem
1. Many alternative proofs of this theorem have been established since then,
but in this small interlude we are interested in the techniques used by Laur-
incikas and Bachchi. Laurincikas was able to obtain the limit theorem of the
following form [15]: deﬁne the probability measure PT on C by

1
2T
for any Borel set A of C. Then

PT pA, σ, ζq “

µ0ptt P r´T, T s : ζpσ ` itq P Aqu

Theorem 2. For any σ ą 1
probability measure QpA, σ, ζq as T Ñ 8.

2, PT pA, σ, ζq is weakly convergent to a certain

The probability measure QpA, σ, ζq can be given explicitly using the ran-

dom variable (3), in fact we have that ([15, Notes Chapter 5]).

µΩ1ptω P Ω1 : ζpσ, ωq P Aquq “ QpA, σ, ζq.

(9)

15

3.3 The distribution of ζpσ, χq

Let s P ts P C : s “ σ ` it, σ ą 1u. Then the Riemann zeta function is given
by the following uniformly convergent series,

ζpsq “

1
ns ,

8

k“1
ÿ

then the assignment t ÞÑ ζpσ ` itq deﬁnes an almost periodic function for
each σ ą 1. Its extension to CpBq is then given by

χ ÞÑ ζpσ, χq “

n´σχpe´it log nq.

8

k“1
ÿ

On the other hand, the behavior of this function in 1
2 ď σ ă 1 changes dra-
matically, that is, for σ in this region we do not have a continuous extension.
Nevertheless, we still have an extension for 1
2 ă σ ă 1 as an L2pBq-function.
In order to prove this, we begin by stating the following theorem about on
the convergence of a series of orthogonal random variables [15, Theorem 2.9]

Theorem 3. Let X1, X2, ... be orthogonal random variables and

E|Xm|2 log2 k ă 8.

8

k“1
ÿ

Xm

8

k“1
ÿ

Then the series

converges almost surely.

Lemma 4. ζpσ, χq is a complex-valued random variable on the Bohr space.

Proof. Deﬁne ϕkpχq “ χpe´it log kq
. Then by the prime factorization theorem
and the orthogonality of T´ log p for diﬀerent primes p, the variables ϕk are
orthogonal. On the other hand, we have that E|ϕk|2 “ 1
k2σ . Hence, by
Theorem 3, ζpσ, χq converges almost surely.

kσ

Recall from equation (4), that a similar random variable was deﬁned on
. In fact,

the probability space Ω1 given by ζpσ, ωq “

1 `

8
k“1

ωppqk
pkσ

pă8

ś

´

ř

¯

16

we will prove that ζpσ, χq is the pull-back of the complex-valued random
variable ζpσ, ωq on Ω1. For this, let γ “ tγ1, .., γnu be an algebraically inde-
pendent set. Let Gγ denote the subgroup of pR, `q freely generated by the
set γ. We deﬁne

Rγ :“ HomrGγ, S1s,

as the set of all homomorphisims from Gγ to the multiplicative group S1.
Each Rγ is homeomorphic with the topological space pS1qn, since any element
χ P Rγ is uniquely determined by its values on the generators γ1, . . . γn. Re-
call that, the Bohr compactiﬁcation is equivalently deﬁned by B “ HomrR, S1s.
This topological space can be identiﬁed with the projective limit of compact
spaces tRγuγ, where γ runs over all the ﬁnite algebraic independent sets
of R. Hence, we have continuous projection maps ργ : B Ñ Rγ, given by
i“1 P pS1qn. Consider now the push-
χ ÞÑ χ|Gγ , or equivalently, χ ÞÑ tχpγiqun
forward measures ργ,˚µB on pS1qn, then it holds true that these measures
coincide with the Haar measure on the compact group pS1qn equipped with
coordinate-wise multiplication [20].

Theorem 4. Let σ ą 1
ζpσ, χq satisﬁes

2 and A be a Borel set of C. Then the distribution of

ζpσ, χq˚µBpAq “ lim
T Ñ8

1
2T

µ0ptt P r´T, T s : ζpσ ` itq P Aqu,

(10)

where µ0 denotes the Lebesgue measure of R.

Proof. Deﬁne the map ρ8 : B Ñ Ω1, where the space Ω1 is deﬁned in (4),
given by χ ÞÑ pχpeit log pkqq8
k“1 where pk runs over the primes. Let A be a
cylindrical set of Ω1, that is

A “ AI ˆ

Ts, AI “

At

sRI
ź
where I is a ﬁnite set of primes, and At Ă T, then the following holds

tPI
ź

8 pAq “ pπI ˝ ρ8q´1pAIq,
ρ´1

where, πI : Ω1 Ñ
tPI Tt is the canonical projection. Note that πI ˝ ρ8 “ ργ,
where γ “ tlog p : p P Iu is an algebraic independent set of R, that is, ργ
is the continuous projection from B to Rγ. Therefore ρ´1
8 pAq is an open
set. Since cylindrical sets form a basis for the topology of Ω1, the map ρ8

ś

17

ř

is continuous. Consider now an element b P Ω1, and an element ˆχ P B such
that ˆχpeit log pkq “ bk. Then we have the following

ˆχρ´1

8 pbAq “ ρ´1

8 pAq,

therefore,

ρ8,˚µBpbAq “ µBp ˆχρ´1

8 pbAqq “ ρ8,˚µBpAq.

(11)

Furthermore, we have that this is a normalized measure, therefore the mea-
sure ρ8,˚µB is the normalized Haar measure µΩ1 on Ω1. Hence, for a ran-
dom variable X : Ω1 Ñ C, we can construct the pull back X ˚ : B Ñ C,
as X ˝ ρ8.
It is easy to see that the distributions coincide in virtue of
(11). Since χ ÞÑ ζpσ, χq, χ P B, is the pull back of the random variable
k“1 ωpkqk´σ, therefore by Theorem 2 and equation (9), the
ω ÞÑ ζpσ, ωq “
theorem is proved.

8

The function B Q χ ÞÑ ζpσ, χq for 1

2 ă σ ă 1 can be consider as an
oﬀ-diagonal version of the Riemann zeta function, since we have that ζpσ, χq
can be identiﬁed by:

HomcontpA˚

f {ˆZ, S1q “

iR{

2πi
log p

pă8
ź

Z Q χ ÞÑ

ζppσ, χq,

pă8
ź

where

ζppσ, χq “

żQ˚

p

φppxq|x|σ

p χppxqd˚µppxq,

and χp P iR{ 2πi

log p Z.

Then limit (10) relates the oﬀ-diagonal zeta function with the Riemann zeta
ζpσ, χq is still an open problem [18]. Never-
function. The behavior of limσÑ 1
theless, the extension of the logarithmic derivative of ζpsq to B in the critical
line has indeed a well-deﬁned relation to the zeta function, as we will show
in the next sections.

2

3.4 Probabilistic interpretation of the local formula

and spectral measures

The logarithmic derivative of the zeta function for Repsq ą 1 is given by

´

ζ 1psq
ζpsq

“

Λpnq
ns “

8

n“1
ÿ

8

log p

p´ks,

pă8
ÿ

k“1
ÿ

18

for ﬁxed σ “ Repsq we can extend this function to an element of CpBq. For
Repsq ą 0, we can construct the p-adic family of random variables given by
the extension of the functions

d
ds

log ζppsq “ ´ log p

p´ks.

8

k“1
ÿ

to CpBq, these extensions are given by the following p-adic Mellin transforms

MppΛp|x|´1

p qqpσ, χq “ log p

p´kσ ˆTlog p´kpχq “

8

k“1
ÿ

Λppkq
pkσ

8

k“1
ÿ

ˆTlog p´kpχq.

Note that

ErMppΛp|x|´1

p qpσ, ¨qs “ 0,

hence for any p-adic random variable Mppf qpσ, ¨q we have,

CovrMppf qpσ, ¨q, MppΛp|x|´1

p qqpσ, ¨qs “ log p

f pp´kqp´2kσ,

(12)

8

k“1
ÿ

and

CovrMppf qpσ, ¨q, MppΛ˚p|x|´1

p qqpσ, ¨qs “ log p

f ppkqp´kp2σ´1q.

(13)

8

k“1
ÿ

Consider now (formally) the oﬀ-diagonal logarithmic derivative given by

χ ÞÑ

Mppσ, Λp|x|´1

p qqpχq,

pă8
ÿ

In a similar way we extend this function to a random variable for 1
2 ă σ ă 1.
For this we need the following result, the proof can be found in [16, Section
17.3].

Proposition 3. Let tXnu8
deﬁned on a probability space pΩ, F, P q. Suppose that

n“1 be a sequence of real-valued random varibles

• tXn : n “ 1, 2, ...u are independent,

• Xn is square-integrable, that is, ErX 2

ns ă 8 p@nq,

19

•

8

n“1 V arpXnq ă 8, where V arpXnq “ ErpXn ´ ErXnsq2s.

ř

8
n“1pXn´ErXnsq is convergent P -almost everywhere; that is,

Then
ErXnsq is convergent as N Ñ 8 P -almost everywhere.

N
n“1pXn´

ř

MppΛp|x|´1

ř
p qqpσ, χq, is

Proposition 4. For σ ą 1
convergent almost everywhere on B.

2 the series χ ÞÑ

pă8

ř

Proof. The function MppΛp|x|´1
holds true that

p qqpσ, χq is clearly an element of L2pBq.

It

8

n“1
ÿ

V arpMppΛp|x|´1

p qqpσ, χqq “

plog pq2 p´2σ
1 ´ p´2σ

pă8
ÿ

since

p´2σ
1 ´ p´2σ ď

22σ
22σ ´ 1

1
p2σ ,

the sum of variances converges for σ ą 1
2.

The random variables tMppΛp|x|´1
sition below. Therefore by Proposition 3 the result is proved.

p qqpσ, χqupă8 are independent by the propo-

Deﬁnition 3. The real numbers λ1, ..., λk are called rationally independent
if they are linearly independent over Z, i.e., for all n1, ..., nk P Z ,

niλi “ 0 ùñ n1 “ ¨ ¨ ¨ nk “ 0.

k

i“1
ÿ

The proof of the following Proposition can be found in [13].

Proposition 5. Let λn, n P N be a sequence of rationally independent real
numbers. Then the functions ˆTλn are stochastically independent under the
Haar measure of B.

Therefore, the sequence of elements ˆTlog p are stochastically independent

under the Haar measure of B.

We denote by ζ 1

ζ pσ, χq the corresponding extension of the logarithmic
derivative given in Proposition 4. Now we study the covariance map attached

20

to this random element. That is, for a random variable Xpχq we are interested
in the map

X ÞÑ CovrXpχq, Re

pσ, χqs.

ζ 1
ζ

Since Er ζ 1
ζ pσ, χqs “ 0, by the Riesz representation theorem, this is just the
linear functional represented by Re ζ 1
ζ . Moreover, under certain restrictions,
this covariance will be equal to a quadratic form attached to a bounded
linear operator, or equivalently a spectral integral, which will be related to
the Weil explicit sums. To begin with this, we start with the following result:
We denote by BpL2pBqq the set of bounded linear operators on the Hilbert
space L2pBq.

Theorem 5. There exists a bounded linear operator Wp on L2pBq such that
its attached quadratic form satisﬁes

xWpMppf qp1{2, ¨q, Mppf qp1{2, ¨qy “ CovrMppf ˚ f ˚qp1{2, ¨q, Wp1s

“ Wppf ˚ f ˚q,

and

ErWpMppf qp1{2, ¨qs “ Wppf q

(14)

(15)

Proof. The Hilbert space L2pBq provides a faithful representation of the C ˚-
algebra CpBq. In particular, for Tk P CpBq its representative is given by

Πpkqψpχq “ ˆTkpχqψpχq, ψ P L2pBq,

Consider the representative of MppΛ ` Λ˚qp 1
the equations p14q and p15q are satisﬁed in virtue of p12q and p13q.

2, ¨q, denoted by Wp P BpBq, then

A similar construction can be done for σ ą 0, generating a bounded

operator Wσ

p . For a function f P C 8

c pR`q we deﬁne

Mf inpf qpσ, χq :“

Mppf qpσ, χq,

pă8
ÿ

note that, since the support of f is a compact set contained in p0, 8q, this
sum is ﬁnite and every p-adic Mellin transform is well deﬁned.

21

Proposition 6. Let f P C 8

c pR`q, then

CovrMf inpf qpσ, ¨q, 2Re

ζ 1
ζ

pσ, ¨qs “

and

8

8

log p

f pp´kqp´2kσ ` log p

f ppkqp´kp2σ´1q

,

pă8 ˜
ÿ

k“1
ÿ

k“1
ÿ

¸

CovrMf inpf qpσ, ¨q, 2Re

lim
σÑ 1
2

ζ 1
ζ

pσ, ¨qs “ Wf inpf q.

Proof. Since Er ζ 1

ζ s “ 0, we have that

CovrMf inpf qpσ, ¨q, 2Re

ζ 1
ζ

pσ, ¨qs “ xMf inpf qpσ, ¨q, 2Re

ζ 1
ζ

pσ, ¨qy,

by the orthogonality property of the Mellin transform for diﬀerent prime
numbers p, the following holds true

CovrMf inpf qpσ, ¨q, 2Re

ζ 1
ζ

pσ, ¨qs “

xMppf qpσ, χq, MppΛ ` Λ˚qp|x|´1

p qpσ, χqy

pă8
ÿ

the result follows from (12) and (13). The above sum is ﬁnite since the
support of f is a compact set, the limit follows immediately.

Example 1. Let X ą 1. And consider gpxq “ 1p1,Xqpxq and gp1q “ gpXq “
1
2. Then

ζ 1
ζ

1
2

1
2

CovrMf inpgqpσ, ¨q, 2Re

pσ, ¨qs “

Λpnq `

ΛpXq “ ψpxq `

ΛpXq

1ănăX
ÿ
As mentioned in section 1.2, it is enough to consider a ﬁnite set of primes
in order to analyze the Weil explicit sum. This will allow us to attach
a quadratic form and a spectral integral to the term Wf inpf ˚ f
q. The
archimedean contribution will be analyzed in the next section. Denote by
P the set of primes. As mentioned before, every f P C 8
c pR`q has attached
a ﬁnite set of primes I Ă P such that for p P PzI, f ppkq “ 0 for all k P Z.
Consider then the class of functions with the same set I denoted by CI,
therefore

˚

f P CI : Mf inpf qpσ, χq “

Mppf qpσ, χq.

pPI
ÿ

22

Theorem 6. For every ﬁnite set I Ă P there exists a bounded linear operator
WI on L2pBq such that for any f P CI its attached quadratic form satisﬁes
xWIMIpf qp1{2, ¨q, MIpf qp1{2, ¨qy “ CovrMIpf ˚ f ˚qp1{2, ¨q, WI1s

and

“

Wppf ˚ f ˚q,

pă8
ÿ

ErWIMIpf qp1{2, ¨qs “

Wppf q

Proof. Let I Ă P and consider the function deﬁned by

pă8
ÿ

B Q χ ÞÑ

MppΛ ` Λ˚p|x|´1

p qq

pPI
ÿ

1
2

ˆ

, χ

“: MIpΛ ` Λ˚qpχq.

˙

Since this function is a ﬁnite sum of continuous functions it follows that,
MIpΛ ` Λ˚qpχq P CpBq. Therefore, we can consider the operator attached to
MIpΛ ` Λ˚qpχq, that is, for F P L2pBq, WIF pχq “ MIpΛ ` Λ˚qpχqF pχq. Let
f P CI. Note that

xWIMf inpf qp1{2, χq, Mf inpf qpχqp1{2, χqy “

MIpΛqpχqMf inpf qpχqMf inpf

˚

qpχqdχ`

żB

MIpΛ˚qpχqMf inpf qpχqMf inpf

˚

qpχqdχ

(16)

żB

The function MIpΛqpχqMf inpf qpχqMf inpf
qpχq has a series representation in
the basis t ˆTrurPR with not necessarily zero coeﬃcients only in the elements of
the form ˆTl log p`m log q`n log r where p, q, r P I and l, m, n P Z. Since tlog pupPP
is a rationally independent set, l log p ` m log q ` n log r “ 0 if and only if
l “ m “ n “ 0 or p “ q “ r and l ` m ` n “ 0. Therefore,

˚

xWIMf inpf qp1{2, χq, Mf inpf qpχqp1{2, χqy “

xWpMppf q, Mppf qy

pPI
ÿ

“ Wf inpf ˚ f

˚

q

(17)

where the last equality follows from Theorem 5. Finally, note that by a
similar argument as in proposition 6 and since WI ˆT0pχq “ WI1pχq “ MIpΛ`
Λ˚qpχq, it holds true that

CovrMIpf ˚ f ˚qp1{2, ¨q, WI1s “

Wppf ˚ f ˚q.

pă8
ÿ

23

We end this section with the following result about the spectral measure

attached to the operator WI.
Theorem 7. Let I Ă P be a ﬁnite set of primes. And let σpWIq denote the
˚
spectrum of the operator WI. Then for f P CI the ﬁnite Weil sum Wf inpf ˚f
q
can be expressed as

Wf inpf ˚ f

˚

q “

żσpWI q

λ dwIpλ, Mf inpf qq,

Where dwI the projection valued measure on σpWIq attached to WI .
Proof. Since the operator WI is bounded and self adjoint by construction,
its spectrum is real, moreover, WI is a multiplication operator therefore its
spectrum σpWIq is given by the range of the continuous function MIpΛ`Λ˚q,
that is

σpWIq “

#

pPI
ÿ

2 log p Re

p´1{2χpTlog p´1q
1 ´ p´1{2χpTlog p´1q

: χ P B

.

+

By the spectral Theorem for self-adjoint bounded operators, there exists a
unique projection-valued measure dwI on σpWp1{2q
q with values in BpL2pBqq
such that

p

Moreover, for every F P L2pBq, and for every Borel set E of σpWIq, the map

WI “

λ dwIpλq.

żσpWI q

dwIpE, F q “ xF, dwIpEqF y,

is a measure on the spectrum of WI. By the theory of functional calculus,
since the operator is a multiplication operator, we can express this measure
as

dwIpE, F q “

|F pχq|2dχ

MI pΛ`Λ˚q´1pEq

ż

Hence, for f P CI we have the following

λ dwIpλ, Mf inpf qq

Wppf ˚ f

˚

q “

pă8
ÿ

żσpWI q

24

4 The Archimedean Place.

In this section we study the Archimedean contribution to the Weil explicit
Inspired by the ideas of S. Haran in [10], we use the techniques in
sum.
q-calulus to get a discretization of W8.
It turns out that the Bohr com-
pactiﬁcation is a natural space to develop a probability theory of the the
discretization of Weil explicit sums, and in general, the tools in q-calculus
are well deﬁned in this space. This allows us to extend the ideas already
presented, including this time the archimedean place.

4.1 The q-Mellin transform and q-random variables

Gq :“ iR{ 2πi
log q´1 Z.
Let q P p0, 1q be ﬁxed. Consider the group denoted by
Note that, for p P P and q “ p´1, we recover the p-adic spaces
p{Z˚
p. In
general, this group corresponds to the Pontryagin dual of the group Gq :“ qZ.
As before, we have that L2p
Gqq, and consequently L2pGqq, is a subspace of
L2pBq for every q P p0, 1q. Let f P L1pGqq X L2pGqq, and consider its Fourier
transform given by

{

Q˚

p

p

where χ P

Gq. Therefore, we have the expression

χ ÞÑ

f pxqχpxqdqx,

żGq

p

f pxqχpxqd˚

q x “

f pqkqqitk

żGq
where χpqq “ qit, and d˚
q x denotes the discrete measure on Gq. As before, we
deﬁne the Mellin transform (for a suitable function f ) at the point s “ σ ` it
as

kPZ
ÿ

Mqpf qpsq :“

f pxqxsd˚

q x “

f pqkqqsk

żGq

kPZ
ÿ

For suitable functions f , the function

t ÞÑ Mqpf qpσ ` itq,
can be extended to a function in L2pBq or CpBq. In any case, its extension
will be called the q-Mellin transform or q-random variable attached to f .
This is given by

B Q χ ÞÑ Mqpσ, f qpχq :“

f pqkqqσkχpqitkq.

kPZ
ÿ

25

Deﬁne the measure dqx :“ p1 ´ qqxd˚

q x, and construct the function

mqpf qpsq :“

f pxqxs´1dqx “ p1 ´ qq

f pqkqqsk.

żGq

kPZ
ÿ

We have that limqÑ1 mqpf q “ Mpf qpsq, where Mpf qpsq is the usual Mellin
transform. As in the p-adic case, the following holds true:
˚

Mqpσ, f

qpχq “ Mqpf qp1 ´ σ, χq,

And for σ “ 1

2, the involution is preserved
˚

Mqpf

qp1{2, χq “ Mqpf qp1{2, χq.

Now we are ready to study the Archimedean contribution.

4.2 The q-digamma and the q-limit.

Now we present an approach to establish the Archimedean contribution of
the Weyl explicit sum as the limit of quadratic forms attached to operators
deﬁned in L2pBq. The archimedean contribution can be written as

1
2πi

1{2`i8

ℜ

Γ1
Γ

W8pf q “ log πf p1q ´

ps{2q

Mpf qpsqds,

(18)

1{2´i8
ż
where Mpf q is the complete Mellin transform of f . The idea is to represent
this integral as a q´limit for q Ñ 1. For this we introduce the following
function which is the q-analogue of the digamma function Γ1
Γ introduced in
[14]. For 0 ă q ă 1 we deﬁne,

ˆ

˙

ψqpsq :“ ´ logp1 ´ qq ` log q

It was established in [14] that

qn`s
1 ´ qn`s .

8

n“0
ÿ

lim
qÑ1

ψqpsq “

Γ1
Γ

psq,

for s ‰ 0, ´1, ´2, ... Hence this gives a q-analogue of the digamma function.
We deﬁne the q-zeta local factor as ζqpsq :“ 1
log q and k P Z.
Hence, we have

1´qs for s ‰ 2πk

d
ds

log ζqpsq “ log q

26

qs
1 ´ qs .

For a prime p and q “ p´1, we have the usual log-derivative of the local
factor. We can rewrite the log-zeta interpolation as

ψqpsq “ ´ logp1 ´ qq `

8

d
ds

log ζqps ` nq.

n“0
ÿ
ds log ζqpσ ` itq is a function in C.
Let 0 ă σ ă 1. Then the function t ÞÑ d
Deﬁne the q-von Mangoldt function as Λqpxq “ log q´1 if x “ q´k for k P N
and zero otherwise. Hence its q-Mellin transform satisﬁes

´Ms

qpΛqq “

d
ds

log ζqpsq.

Therefore, the logarithm of the q-zeta local factor is a q-random variable on
the Bohr space given by the function Mσ
p pΛqqpχq. For ﬁxed q, let δ ą 0 such
that q ă δ ă 1. Then we have

Therefore, for ﬁxed Repsq “ σ ą 0 and by the Weierstrass M-test we have
that the function

qs
1 ´ qs

ď

1
1 ´ δ

qRepsq.

ˇ
ˇ
ˇ
ˇ

ˇ
ˇ
ˇ
ˇ

d
ds

8

n“0
ÿ

t ÞÑ

log ζqpσ ` n ` itq,

is a well-deﬁned function in C. Therefore it can be extended to a function on
CpBq. Consider the function ψq2p s
2q. Then, we have the following expansion
at σ “ 1
2,

ψq2p

1
4

` it{2q “ ´logp1 ´ q2q ` log q2

qikt qk{2

1 ´ q2k ,

8

k“1
ÿ

Since we are interested in ´ℜp Γ

Γ1 q, we consider the following:

´ℜψq2p

1
4

` it{2q “ logp1 ´ q2q ` log q´1

qikt q|k|{2
1 ´ q2|k|

.

k‰0
ÿ

We denote by Hqpχq P CpBq the extension of the almost periodic function
´ℜψ2

q p1{4 ` it{2q to B. Consider the following q-version of (18)

M1{2

q pf qpχqHqpχqdχ “ f p1q logp1´q2q`plog q´1q

żB

1

1 ´ q2|n| minpq´2n, 1qf pqnq,

n‰0
ÿ

27

it turns out, that the expression on the right, coincides with one of the
discretizations given by S. Haran in [10], where it is showed that the RHS
converges to the integral in equation (18) as q Ñ 1 . Moreover, if we deﬁne
˜Hqpχq “ Hqpχq ` log π, then

Mqpf qp1{2, χq ˜Hqpχqdχ Ñ W8pf q

(19)

żB

as q Ñ 1, [10]. This allows us to have the following Theorem:

Theorem 8. For every I Ă P there exists a bounded linear operator WI,q
on L2pBq such that for any f P CI its attached quadratic form satisﬁes for
MI,qpf qpχq :“ Mf inpf qpχq ` Mqpf qp1{2, χq the following equality

xWI,qMI,qpf q, MI,qpf qy “ CovrMI,qpf ˚ f

˚

q, WI,q1s ` logpp1 ´ q2qπqf ˚ f

˚

p1q

Moreover,

CovrMI,qpf ˚ f

˚

q, WI,q1s ` logpp1 ´ q2qπqf ˚ f

˚

p1q Ñ W pf ˚ f

˚

q

As q Ñ 1.

Proof. Consider the multiplication operator attached to the function ˜Hqpχq,
denoted by Wq. Deﬁne the operator WI,q :“ Wq ` WI, where WI is deﬁned
in Theorem 6. Since I consists of ﬁnitely many primes, we can construct a
sequence q Ñ 1 such that tlog qu Y tlog pupPI is a rationally independent set.
Then a similar argument as the one given in Theorem 6 implies

xWI,qMI,qpf q, MI,qpf qy “

xWrMrpf q, Mrpf qy

rPtquYI
ÿ
“ Wf inpf ˚ f

˚

q ` xWqMqpf q, Mqpf qy.

Now the result follows from limit (19).

Corollary 1. The following limit holds

ErMI,qpf ˚ f

˚

qWI,q1s Ñ W pf ˚ f

˚

q

as q Ñ 1.

28

It follows that the existence of a sequence q Ñ 1 such that

ErMI,qpf ˚ f

˚

qWI,q1s ď 0,

implies the Riemann hypothesis. Or equivalently, following the observation
of [10], the Riemann hypothesis is equivalent to the bound

CovrMI,qpf ˚ f

˚

q, WI,q1s ď ||f ||2

L2pGqq log

p1 ´ qq´1
2π

ˆ

˙

for a sequence of real numbers q P p0, 1q convergent to 1. Since the operator
WI,q is a multiplication operator, its spectrum σpWI,qq is given by the range
of

B Q χ ÞÑ

log p Re

pPI
ÿ

p´1{2χpTlog p´1q
1 ´ p´1{2χpTlog p´1q

` logpp1 ´ q2qπq ` log q´1

k‰0
ÿ

χpTlog qqk q|k|{2

1 ´ q2|k| ` log π.

(20)

Therefore, by similar arguments in the proof of Theorem 7, we have the
following result:

Theorem 9. Let I Ă P be a ﬁnite set of primes. Then for f P CI the Weil
sum can be expressed as

W pf ˚ f

˚

q “ lim
qÑ1

żσpWI,q q

λ dwI,qpλ, f q

where, the measure dwI,qp¨, f q only depend on the function f and the number
q.

Proof. Given f P CI, by the spectral Theorem for self-adjoint bounded op-
erators, there exists a measure dwI,qp¨, f q such that

xWI,qMI,qpf q, MI,qpf qy “

λ dwI,qpλ, f q,

żσpWI,q q

the result follows from Theorem 8.

29

The positivity of these integrals will imply the Riemann Hypothesis. Let

f P CI and consider the linear functional deﬁned on CpBq given by

CpBq Q F ÞÑ

F pχq|MI,qpf ˚ f

˚

qpχq|2dχ.

żB

˚

Since this deﬁne a positive linear functional, by the Riesz-Markov Represen-
tation Theorem, there exists a unique Radon measure df χ on B. Suppose
that ||MI,qpf ˚ f
q||L2pBq “ 1. Then it is clear that df χ deﬁnes a probabil-
ity measure on B. Consider the random variable deﬁned by the function
(20), that is Wq,I1pχq (this is a truncation of the real part of the logarithmic
derivative of the zeta function viewed as a oﬀ-diagonal function or as an ex-
tension on B). The probability distribution of Wq,I1pχq is then given by the
spectral measure dwI,qp¨, f q of the operator Wq,I, and deﬁne a probability
measure on the spectrum σpWI,qq. As a corollary of the last result, we have
the following.

Corollary 2. Let λ be a random variable in the probability space
pσpWI,qq, BpσpWI,qqq, dwI,qp¨, f qq. Then

Erλs “ xWI,qMI,qpf q, MI,qpf qy

Remark 4. In [4], J.F Burnol reproved S. Haran explicit formula [9]. In
an older paper [5], J. F. Burnol proposed the following strategy to prove
the Riemann hypothesis: After a change of sign and deﬁning Cpf ˚ g˚q :“
´W pf ˚ g˚q for f, g P C 8
c pRq, it is proposed to ﬁnd a generalized, stationary,
zero mean stochastic process with C “ A˚{Q˚ as ”time” whose covariance
would be C. That is, to have a probability measure µ on the distributions on
the classes of ideles denoted by D and the identity:

Xf pdqXgpdqdµpdq “ Cpf ˚ g˚q,

D

ż

where f, g are considered as test-functions on C (for details see [9]), and Xf
and Xg are to associated ”coordinates” on the space of distributions d ÞÑ
Xf pdq “ dpf q and d ÞÑ Xgpdq “ dpgq. So Cpf ˚ g˚q is the covariance of the
random variables deﬁned by f and g. This implies the Riemann hypothesis
since this shows that ´W pf ˚ f
q is a variance and therefore is a positive
number. For simplicity consider the case when Supp f, Supp g Ă p 1
2, 2q. In
this case the corresponding operator in theorem 8 is given by WI,q “ Wq, that

˚

30

is, the multiplication operator attached to the function ˜Hqpχq, and Cpf ˚ g˚q
is then given by the limit (Theorem 8)

Mqpf qp1{2, χqMqpgqp1{2, χq ˜Hqpχqdχ “ ´Cpf ˚ g˚q,

lim
qÑ1

żB

this is not a limit of variances since the linear functional

CpBq Q f ÞÑ

f p´ ˜Hqpχqqdχ,

żB
deﬁnes a signed measure and not a probability measure. On the other hand,
for q suﬃciently close to 1, the integrals of the above limit are positive, since
in this case the positivity has been proved, [7]. In this work we showed that
the explicit sums can be understanded within a probability framework. Nev-
ertheless, the strategy of J.F Burnol remains open.

5 Outlook.

The ﬁrst step in constructing quantum mechanics from classical mechanics
is given by the quantization rule that replaces the Poisson bracket of observ-
ables, i.e. functions on the phase space, by the commutator of operators on
an abstract Hilbert space H. This operators are the corresponding observ-
ables of quantum theory [8]. The corresponding algebra of operators (the so
called Heisenberg algebra) is represented on the Hilbert space Hsch of square-
integrable functions L2pR, dxq, this is called the Schr¨odinger’s representation.
The celebrated Stone-von Neumann theorem establishes that any irreducible
representation of the Heinsenberg algebra with certain commutation relations
is unitarily equivalent to the Schr¨odinger’s representation. Nevertheless, mo-
tivated by the physical principle of a discrete structure of space, one may
relax one or some of the regularity assumpltions of the uniqueness theorem,
for example, one can assume that one of the operators of the Heisenberg al-
gebra is not weakly continuous. As a consequence, the Stone-von Neumann
theorem does not hold, and therefore we obtain a non-unitarily equivalent
representation, this is the so called polymer representation. Moreover, as a
consequence of this, the operator ˆp “ ´i~ d
dx is not well deﬁned (but can be
approximated!), which is expected in a discrete space. It turns out that the
Hilbert space Hpoly of such representation is given by Hpoly “ L2pB, dχq.
Polya and Hilbert proposed the idea that in order to understand the location

31

of the zeros of the Riemann zeta function, one should ﬁnd a Hilbert space
H and an operator D in H whose spectrum is given by the nontrivial zeros
of the zeta function. This project is still carry on by, for example, the work
of Alain Connes or Shai Haran. The Hilbert space L2pBq is directly related
with two theories: the fundamental role as the Hilbert space in the Polymer
representation, and as shown, for example, in Theorem 4, with the theory
of distributions of the zeta function initiated by Harald Bohr. Theorem 8,
Corollary 2 and Theorem 9, shown how this space also allow us to have a
probabilistic interpretation and an expression of the Weil explicit sum as a
limit of integrals respect to spectral measures of operators deﬁned on this
space. The author believes that more information of the zeros of the zeta
function and more possible interesting results will emerge on the study of the
connections between PQM and the ”oﬀ-diagonal” functions presented here.

References

[1] K. Matsumoto A. Laurinˇcikas. The universality of zeta-functions at-
tached to certain cusp forms. Acta Arithmetica, 98(4):345–359, 2001.

[2] B. Bagchi. Statistical behaviour and universality properties of the Rie-
mann zeta-function and other allied Dirichlet series. PhD thesis, Indian
Statistical Institute, 1981.

[3] H. Bohr and B. Jessen.

¨Uber die werteverteilung der riemannschen

zetafunktion. Acta Mathematica, 54(1):1–35, Jul 1930.

[4] J.F Burnol. On fourier and zeta(s). Forum Mathematicum, 16(6):789–

840, 2004.

[5] J.F Burnol.

explicit
arXiv:math/9809119, September 1998, revised November 1998.

formula

The

and

a

propagator.

[6] A. Connes. Trace formula in noncommutative geometry and the zeros of
the riemann zeta function. Journ´ees ´equations aux d´eriv´ees partielles,
pages 1–28, 1997.

[7] A. Connes and C. Consani. Weil positivity and trace formula the

archimedean place. Selecta Mathematica, 27(4):77, Jul 2021.

32

[8] E. Flores-Gonz´alez, H. A. Morales-T´ecotl, and J. D. Reyes. Propagators
in polymer quantum mechanics. Annals of Physics, 336:394–412, 2013.

[9] S. Haran. Riesz potentials and explicit sums in arithmetic. Inventiones

mathematicae, 101(3):697–704, 1990.

[10] S. Haran. The mysteries of the real prime, volume NS 25 of London

Math. Soc. Mono. Clarendon Press, 2001.

[11] E. Hewitt and K. A. Ross. Abstract Harmonic Analysis I. Springer-

Verlag, Berlin, 1987.

[12] G. Shilov I. Gelfand, D. Raikov. Commutative normed rings. Chelsea

Publishing Company Chelsea, New York, 1964.

[13] M. Kac. Statistical independence in probability, analysis and number

theory. The Mathematical Association of America, 1959.

[14] C. Krattenthaler and H.M. Srivastava. Summations for basic hypergeo-
metric series involving a q-analogue of the digamma function. Computers
and Mathematics with Applications, 32(3):73–91, 1996.

[15] A. Laurinˇcikas. Limit Theorems for the Riemann Zeta-Function. Math-

ematics and Its Applications. Springer Dordrecht, 1995.

[16] M. Lo`eve. Probability Theory. D. Van N. Company, London, 1963.

[17] B. Riemann. ¨Uber die anzahl der primzahlen unter einer gegebenen
gr¨osse. Monatsberichte der Berliner Akademie, pages 671–680, 1860.

[18] S. Takanobu. Bohr–Jessen process and functional limit theorem. Kyoto

Journal of Mathematics, 54(2):401 – 426, 2014.

[19] J. Tate. Fourier analysis in number ﬁelds and hecke’s zeta-functions.
page 305–347. Proc. Instructional Conf., Brighton, 1965), Thompson,
Washington, D.C., 1950.

[20] T. Thiemann. Modern Canonical Quantum General Relativity. Cam-

bridge university press, 2007.

[21] J. M. Velhinho. The quantum conﬁguration space of loop quantum
cosmology. Classical and Quantum Gravity, 24(14):3745, jul 2007.

33

[22] A. Weil. Sur les “formules explicites” de la th´eorie des nombres premiers.

Comm. S´em. Math. Univ. Lund, pages 252–265, 1952.

[23] H. Yoshida. On hermitian forms attached to zeta functions. zeta func-

tions in geometry. Adv. Stud. Pure Math., 21, 1992.

34

